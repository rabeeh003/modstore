import{r as l,j as e,A as N,B as y,m as B,N as J,a as L,b as V,c as $,i as K,s as A,l as _,L as M,T as F,t as P,d as Q,e as U,n as T,f as X,g as Y,h as Z,E as ee,k as se,o as k}from"./index-BtULa5SP.js";const te=({selectedFilesUrl:i,setSelectedFilesUrl:u,idd:p})=>{const s=l.useRef(null),[c,h]=l.useState([]),[j,f]=l.useState([]),[w,d]=l.useState([]),g=5;l.useEffect(()=>{d(g-(i.length+c.length)),console.log("new files url :",c),console.log("new files :",j)},[i,c]);const v=async a=>{const o=Array.from(a.target.files);if(o.length>0){const b=o[0],r=new FormData;r.append("image",b),r.append("application",p);try{console.log("start to update:"),N.post(y+"ref/img/",r).then(x=>{u(m=>[...m,x.data]),console.log("image updated : ",x.data)}),console.log("DON DON DON DONs")}catch(x){console.error("Error deleting image:",x)}}},C=a=>{s.current.click()},S=async(a,o,b)=>{if(b==="existing"){i[a];try{await N.delete(y+`/ref/img/${o.id}/`),u(r=>r.filter((x,m)=>m!==a))}catch(r){console.error("Error deleting image:",r)}}else h(r=>r.filter((x,m)=>m!==a)),f(r=>r.filter((x,m)=>m!==a))};return e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"mt-5 w-full flex flex-col items-center",children:[i.map((a,o)=>e.jsxs("div",{className:"flex items-center justify-between bg-green-100 border border-green-200 rounded-xl mt-2 p-4 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:a.image,alt:a.id,className:"w-16 h-16 object-cover rounded-lg mr-4"}),e.jsx("p",{className:"text-sm font-medium ml-4",children:a.name})]}),e.jsx("button",{type:"button",className:"w-10 h-10 flex items-center justify-center text-red-700 bg-transparent border-none rounded-full cursor-pointer transition-all duration-300 ease-in-out hover:text-white hover:bg-red-700",onClick:()=>S(o,a,"existing"),children:e.jsx("span",{className:"material-symbols-rounded",children:"delete"})})]},o)),c==null?void 0:c.map((a,o)=>e.jsxs("div",{className:"flex items-center justify-between bg-green-100 border border-green-200 rounded-xl mt-2 p-4 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:c[o],alt:o,className:"w-16 h-16 object-cover rounded-lg mr-4"}),e.jsx("p",{className:"text-sm font-medium ml-4",children:a.name})]}),e.jsx("button",{type:"button",className:"w-10 h-10 flex items-center justify-center text-red-700 bg-transparent border-none rounded-full cursor-pointer transition-all duration-300 ease-in-out hover:text-white hover:bg-red-700",onClick:()=>S(o,"new"),children:e.jsx("span",{className:"material-symbols-rounded",children:"delete"})})]},i.length+o)),i.length+c.length<g&&e.jsxs("div",{className:"flex items-center justify-between bg-white border border-dashed border-green-700 rounded-xl mt-2 p-4 w-full max-w-lg cursor-pointer",onClick:C,children:[e.jsx("input",{type:"file",ref:s,onChange:v,style:{display:"none"},accept:"image/*"}),e.jsx("span",{className:"material-symbols-rounded text-3xl w-12 h-12 flex items-center justify-center rounded-full bg-green-100 text-green-700",children:"add"}),e.jsx("p",{className:"text-sm font-medium ml-4",children:"Add Image"})]})]})})};function le({isOpen:i,onClose:u,name:p,data:s,setRefech:c}){const[h,j]=l.useState(""),[f,w]=l.useState(""),[d,g]=l.useState(null),[v,C]=l.useState(null),[S,a]=l.useState(null),[o,b]=l.useState(!0),[r,x]=l.useState(""),[m,D]=l.useState("");l.useState([]);const[R,I]=l.useState([]),[E,O]=l.useState([]),z=n=>{const t=n.target.files[0];g(t)},G=()=>{g(null)},W=()=>{a(v),C(null)};l.useEffect(()=>{s&&(j(s.name||""),w(s.category||""),D(s.description||""),O(s.labels||[]),C(s.icon||null),b(s.dtype||null),x(s.download||"")),N.get(y+`ref/img/?application=${s.id}`).then(n=>{console.log(n.data),I(n.data.results)}).catch(n=>console.error(n))},[s]);const q=()=>{const n=new FormData;s.name!==h&&n.append("name",h),s.category!==f&&n.append("category",f),s.download!==r&&n.append("download",r),s.dtype!==o&&(o==!0?n.append("dtype",!0):o==!1&&n.append("dtype",!1)),d&&n.append("icon",d),s.description!==m&&n.append("description",m),E.forEach(t=>{n.append("labels",t)}),N.patch(y+`applications/${s.id}/`,n,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{c(H=>H++),console.log(t.data),u(),T("s","Post updated")}).catch(t=>{console.error(t),T("e",t.message)})};return e.jsxs(B,{isOpen:i,onClose:u,isDismissable:!1,size:"xl",className:"modal-overlay scrollbar-hide scroll-smooth",scrollBehavior:"inside",children:[e.jsx(J,{}),e.jsx(L,{children:n=>e.jsxs(e.Fragment,{children:[e.jsx(V,{children:e.jsx("h2",{children:p})}),e.jsx($,{children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex w-full ",children:e.jsx(K,{type:"text",label:"App name",value:h,onChange:t=>j(t.target.value),description:"This also the heading of the post."})}),e.jsx("div",{className:"sm:flex gap-2 justify-between",children:e.jsxs(A,{className:"w-full",description:"Select the category of the post.",value:f,onChange:t=>{console.log(f),w(t.target.value),console.log(t.target.value," : value.")},children:[e.jsx(_,{value:"android",children:"Android"},"android"),e.jsx(_,{value:"windows",children:"Windows"},"windows")]})}),e.jsx("div",{className:"flex-none",children:e.jsx(M,{groupSelected:E,setGroupSelected:O})}),e.jsxs("div",{className:"flex-none",children:[e.jsx("label",{className:"text-small",children:"Icon Image:"}),v?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:v,alt:"Icon Preview",className:"max-w-[100px] w-full rounded-lg"}),e.jsx("button",{type:"button",className:"mt-2 text-red-500 bg-transparent border-none cursor-pointer hover:text-white hover:bg-purple-700",onClick:W,children:e.jsx(F,{})})]}):e.jsx("div",{children:d?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:URL.createObjectURL(d),alt:"Icon Preview",className:"max-w-[100px] w-full rounded-lg"}),e.jsx("button",{type:"button",className:"mt-2 text-red-500 bg-transparent border-none cursor-pointer hover:text-white hover:bg-purple-700",onClick:G,children:e.jsx(F,{})})]}):e.jsx("input",{type:"file",id:"icon",accept:"image/*",className:"max-w-xs w-full",onChange:z})})]}),e.jsx("div",{children:e.jsx(P,{label:"Download file / page link",description:"Add download file path or page link.",value:r,onChange:t=>x(t.target.value)})}),e.jsx("div",{className:"sm:flex gap-2 justify-between",children:e.jsxs(A,{label:"Select download type","aria-label":"",className:"w-full",description:"Select the type of link.",onChange:t=>{b(t.target.value),console.log("file type ",t.target.value)},children:[e.jsx(_,{value:!0,children:"File link"},"true"),e.jsx(_,{value:!1,children:"Page link"},"false")]})}),e.jsx("div",{children:e.jsx(P,{label:"Description",value:m,onChange:t=>D(t.target.value)})}),e.jsx("div",{children:e.jsx(te,{idd:s.id,selectedFilesUrl:R,setSelectedFilesUrl:I})})]})}),e.jsxs(Q,{children:[e.jsx("button",{className:"close-button",onClick:n,children:"Close"}),e.jsx(U,{variant:"shadow",className:"bg-success-500",onClick:q,children:"Submit"})]})]})})]})}function ne({isOpen:i,onClose:u,data:p}){return l.useState([]),e.jsx(B,{isOpen:i,onClose:u,size:"xl",className:"modal-overlay scrollbar-hide scroll-smooth",scrollBehavior:"inside",children:e.jsx(L,{children:s=>e.jsxs(e.Fragment,{children:[e.jsx(V,{children:e.jsx("h2",{children:p.name})}),e.jsx($,{children:e.jsx("div",{children:e.jsx(X,{width:"100px",src:p.icon})})})]})})})}function oe({data:i,setRefech:u}){const[p,s]=l.useState(!1),[c,h]=l.useState(!1),j=()=>{s(!0)},f=()=>{s(!1)},w=()=>{N.delete(y+`applications/${i.id}/`).then(d=>{console.log("res of delete :"+d),u(g=>g++)}).catch(d=>console.error(d))};return e.jsxs(e.Fragment,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsx(ee,{})}),e.jsxs(se,{"aria-label":"Action event example",children:[e.jsx(k,{onClick:()=>h(!0),children:"View"},"view"),e.jsx(k,{onClick:j,children:"Edit"},"edit"),e.jsx(k,{onClick:w,children:"Delete"},"delete")]})]}),e.jsx(le,{name:"Edit app",isOpen:p,onClose:f,data:i,setRefech:u}),e.jsx(ne,{isOpen:c,onClose:()=>{u(d=>d++),h(!1)},data:i})]})}export{oe as default};
