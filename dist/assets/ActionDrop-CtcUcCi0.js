import{r as l,j as e,A as v,B as b,m as B,N as K,a as $,b as R,c as V,i as I,s as A,l as S,L as M,T as L,t as _,d as Q,e as D,n as T,f as U}from"./index-Li4BmCAV.js";const X=({selectedFilesUrl:i,setSelectedFilesUrl:p,idd:c})=>{const s=l.useRef(null),[d,u]=l.useState([]),[x,f]=l.useState([]),[N,m]=l.useState([]),j=5;l.useEffect(()=>{m(j-(i.length+d.length)),console.log("new files url :",d),console.log("new files :",x)},[i,d]);const y=async a=>{const o=Array.from(a.target.files);if(o.length>0){const w=o[0],r=new FormData;r.append("image",w),r.append("application",c);try{console.log("start to update:"),v.post(b+"ref/img/",r).then(g=>{p(h=>[...h,g.data]),console.log("image updated : ",g.data)}),console.log("DON DON DON DONs")}catch(g){console.error("Error deleting image:",g)}}},C=a=>{s.current.click()},k=async(a,o,w)=>{if(w==="existing"){i[a];try{await v.delete(b+`/ref/img/${o.id}/`),p(r=>r.filter((g,h)=>h!==a))}catch(r){console.error("Error deleting image:",r)}}else u(r=>r.filter((g,h)=>h!==a)),f(r=>r.filter((g,h)=>h!==a))};return e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"mt-5 w-full flex flex-col items-center",children:[i.map((a,o)=>e.jsxs("div",{className:"flex items-center justify-between bg-green-100 border border-green-200 rounded-xl mt-2 p-4 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:a.image,alt:a.id,className:"w-16 h-16 object-cover rounded-lg mr-4"}),e.jsx("p",{className:"text-sm font-medium ml-4",children:a.name})]}),e.jsx("button",{type:"button",className:"w-10 h-10 flex items-center justify-center text-red-700 bg-transparent border-none rounded-full cursor-pointer transition-all duration-300 ease-in-out hover:text-white hover:bg-red-700",onClick:()=>k(o,a,"existing"),children:e.jsx("span",{className:"material-symbols-rounded",children:"delete"})})]},o)),d==null?void 0:d.map((a,o)=>e.jsxs("div",{className:"flex items-center justify-between bg-green-100 border border-green-200 rounded-xl mt-2 p-4 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:d[o],alt:o,className:"w-16 h-16 object-cover rounded-lg mr-4"}),e.jsx("p",{className:"text-sm font-medium ml-4",children:a.name})]}),e.jsx("button",{type:"button",className:"w-10 h-10 flex items-center justify-center text-red-700 bg-transparent border-none rounded-full cursor-pointer transition-all duration-300 ease-in-out hover:text-white hover:bg-red-700",onClick:()=>k(o,"new"),children:e.jsx("span",{className:"material-symbols-rounded",children:"delete"})})]},i.length+o)),i.length+d.length<j&&e.jsxs("div",{className:"flex items-center justify-between bg-white border border-dashed border-green-700 rounded-xl mt-2 p-4 w-full max-w-lg cursor-pointer",onClick:C,children:[e.jsx("input",{type:"file",ref:s,onChange:y,style:{display:"none"},accept:"image/*"}),e.jsx("span",{className:"material-symbols-rounded text-3xl w-12 h-12 flex items-center justify-center rounded-full bg-green-100 text-green-700",children:"add"}),e.jsx("p",{className:"text-sm font-medium ml-4",children:"Add Image"})]})]})})};function Y({isOpen:i,onClose:p,name:c,data:s,setRefech:d}){const[u,x]=l.useState(""),[f,N]=l.useState(""),[m,j]=l.useState(null),[y,C]=l.useState(null),[k,a]=l.useState(null),[o,w]=l.useState(!0),[r,g]=l.useState(""),[h,E]=l.useState("");l.useState([]);const[z,O]=l.useState([]),[F,P]=l.useState([]),G=n=>{const t=n.target.files[0];j(t)},W=()=>{j(null)},q=()=>{a(y),C(null)};l.useEffect(()=>{s&&(x(s.name||""),N(s.category||""),E(s.description||""),P(s.labels||[]),C(s.icon||null),w(s.dtype||null),g(s.download||"")),v.get(b+`ref/img/?application=${s.id}`).then(n=>{console.log(n.data),O(n.data.results)}).catch(n=>console.error(n))},[s]);const H=()=>{const n=new FormData;s.name!==u&&n.append("name",u),s.category!==f&&n.append("category",f),s.download!==r&&n.append("download",r),s.dtype!==o&&(o==!0?n.append("dtype",!0):o==!1&&n.append("dtype",!1)),m&&n.append("icon",m),s.description!==h&&n.append("description",h),F.forEach(t=>{n.append("labels",t)}),v.patch(b+`applications/${s.id}/`,n,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{d(J=>J++),console.log(t.data),p(),T("s","Post updated")}).catch(t=>{console.error(t),T("e",t.message)})};return e.jsxs(B,{isOpen:i,onClose:p,isDismissable:!1,size:"xl",className:"modal-overlay scrollbar-hide scroll-smooth",scrollBehavior:"inside",children:[e.jsx(K,{}),e.jsx($,{children:n=>e.jsxs(e.Fragment,{children:[e.jsx(R,{children:e.jsx("h2",{children:c})}),e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex w-full ",children:e.jsx(I,{type:"text",label:"App name",value:u,onChange:t=>x(t.target.value),description:"This also the heading of the post."})}),e.jsx("div",{className:"sm:flex gap-2 justify-between",children:e.jsxs(A,{className:"w-full",description:"Select the category of the post.",value:f,onChange:t=>{console.log(f),N(t.target.value),console.log(t.target.value," : value.")},children:[e.jsx(S,{value:"android",children:"Android"},"android"),e.jsx(S,{value:"windows",children:"Windows"},"windows")]})}),e.jsx("div",{className:"flex-none",children:e.jsx(M,{groupSelected:F,setGroupSelected:P})}),e.jsxs("div",{className:"flex-none",children:[e.jsx("label",{className:"text-small",children:"Icon Image:"}),y?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:y,alt:"Icon Preview",className:"max-w-[100px] w-full rounded-lg"}),e.jsx("button",{type:"button",className:"mt-2 text-red-500 bg-transparent border-none cursor-pointer hover:text-white hover:bg-purple-700",onClick:q,children:e.jsx(L,{})})]}):e.jsx("div",{children:m?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:URL.createObjectURL(m),alt:"Icon Preview",className:"max-w-[100px] w-full rounded-lg"}),e.jsx("button",{type:"button",className:"mt-2 text-red-500 bg-transparent border-none cursor-pointer hover:text-white hover:bg-purple-700",onClick:W,children:e.jsx(L,{})})]}):e.jsx("input",{type:"file",id:"icon",accept:"image/*",className:"max-w-xs w-full",onChange:G})})]}),e.jsx("div",{children:e.jsx(_,{label:"Download file / page link",description:"Add download file path or page link.",value:r,onChange:t=>g(t.target.value)})}),e.jsx("div",{className:"sm:flex gap-2 justify-between",children:e.jsxs(A,{label:"Select download type","aria-label":"",className:"w-full",description:"Select the type of link.",onChange:t=>{w(t.target.value),console.log("file type ",t.target.value)},children:[e.jsx(S,{value:!0,children:"File link"},"true"),e.jsx(S,{value:!1,children:"Page link"},"false")]})}),e.jsx("div",{children:e.jsx(_,{label:"Description",value:h,onChange:t=>E(t.target.value)})}),e.jsx("div",{children:e.jsx(X,{idd:s.id,selectedFilesUrl:z,setSelectedFilesUrl:O})})]})}),e.jsxs(Q,{children:[e.jsx("button",{className:"close-button",onClick:n,children:"Close"}),e.jsx(D,{variant:"shadow",className:"bg-success-500",onClick:H,children:"Submit"})]})]})})]})}function Z({isOpen:i,onClose:p,data:c}){const[s,d]=l.useState([]);return l.useEffect(()=>{v.get(b+"labels/").then(u=>{console.log("labels : ",u.data);const x=u.data.results.filter(f=>c.labels.includes(f.id));d(x)}).catch(u=>{console.error("There was an error fetching the labels!",u)})},[c,b]),e.jsx(B,{isOpen:i,onClose:p,size:"xl",className:"modal-overlay scrollbar-hide scroll-smooth",scrollBehavior:"inside",children:e.jsx($,{children:u=>e.jsxs(e.Fragment,{children:[e.jsx(R,{children:e.jsx("h2",{children:c.name})}),e.jsx(V,{className:"",children:e.jsxs("div",{className:"w-full",children:[e.jsx(U,{width:"100px",className:"pb-3 m-auto",src:c.icon}),e.jsx("div",{children:s==null?void 0:s.map(x=>e.jsx("span",{className:"text-sm border-2 py-1 font-medium md:py-0 px-2 mr-2 rounded-2xl",children:x.name},x.id))}),e.jsxs("div",{className:"flex flex-col py-3 gap-2",children:[e.jsx(I,{type:"text",disabled:!0,label:"Category",value:c.category}),e.jsx(I,{type:"text",disabled:!0,label:"Download type",value:c.dype==!0?"File Link":"Page Link"}),e.jsx(_,{disabled:!0,label:"Downlad data",value:c.download}),e.jsx(_,{disabled:!0,label:"Description",value:c.description})]})]})})]})})})}function se({data:i,setRefech:p}){const[c,s]=l.useState(!1),[d,u]=l.useState(!1),x=()=>{s(!0)},f=()=>{s(!1)},N=()=>{v.delete(b+`applications/${i.id}/`).then(m=>{console.log("res of delete :"+m),p(j=>j++)}).catch(m=>console.error(m))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap gap-1 m-3",children:[e.jsx(D,{variant:"faded",className:"min-w-0 p-3",color:"success",onClick:()=>u(!0),children:"View"}),e.jsx(D,{variant:"faded",className:"min-w-0 p-3",color:"warning",onClick:x,children:"Edit"}),e.jsx(D,{variant:"faded",className:"min-w-0 p-3",color:"danger",onClick:N,children:"Delete"})]}),e.jsx(Y,{name:"Edit app",isOpen:c,onClose:f,data:i,setRefech:p}),e.jsx(Z,{isOpen:d,onClose:()=>{p(m=>m++),u(!1)},data:i})]})}export{se as default};
